source("read_data.R")

train$year = factor(year(train$timestamp))
train$month = factor(month(train$timestamp))
train$build_year = as.integer(train$build_year)
train = train %>% filter(build_year > 1899 & build_year < 2020 & !is.na(build_year))
linear_model = lm(price_doc ~ floor + I(floor^2) + full_sq + I(full_sq^2) + product_type + sub_area + year + month + build_year + I(build_year^2), data=train)
summary(linear_model)
prediction.lm = data_frame(actual =  linear_model$model$price_doc, predicted = linear_model$fitted.values)
ggplot(prediction.lm) + geom_point(aes(actual, predicted)) + geom_abline(colour="red")
